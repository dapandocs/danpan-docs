import{_ as t,a as E}from"./chunks/CopyRight.vue_vue_type_script_setup_true_lang.67549825.js";import{_ as y,C as F,o as i,c as u,H as s,w as l,Q as e,k as n,a as o}from"./chunks/framework.27021b64.js";import{_ as C}from"./chunks/index.e5e15ed4.js";import"./chunks/CloseOutlined.9c3246b4.js";import"./chunks/isObjectLike.46b91259.js";import"./chunks/Serializer.fad5b415.js";import"./chunks/LeftOutlined.9040821c.js";import"./chunks/EyeOutlined.53cc40ff.js";const cs=JSON.parse('{"title":"某书 x-s、x-t、x-s-common、x-b3-traceid 逆向分析","description":"","frontmatter":{},"headers":[],"relativePath":"reverse/jsreverse/xhs2.md","filePath":"reverse/jsreverse/xhs2.md","lastUpdated":1718767715000}'),b={name:"reverse/jsreverse/xhs2.md"},B=e("",5),A=n("h3",{id:"逆向分析",tabindex:"-1"},[o("逆向分析 "),n("a",{class:"header-anchor",href:"#逆向分析","aria-label":'Permalink to "逆向分析"'},"​")],-1),m=n("h4",{id:"x-b3-traceid",tabindex:"-1"},[o("x-b3-traceid "),n("a",{class:"header-anchor",href:"#x-b3-traceid","aria-label":'Permalink to "x-b3-traceid"'},"​")],-1),d=n("p",null,[o("全局搜索 "),n("code",null,"x-b3-traceid"),o("，找到位置后打上断点")],-1),D=n("p",null,[o("可以发现 "),n("code",null,"x-b3-traceid"),o(" 是 "),n("code",null,"rt()"),o(" 生成的，找到其位置如下：")],-1),_=e("",4),q=e("",3),h=e("",8),g=e("",2),x=n("p",null,"插桩技巧：",-1),v=n("ul",null,[n("li",null,"从入参开始分析"),n("li",null,"从返回值开始分析")],-1),I=n("p",null,"这两种技巧要结合使用，效果才能最佳。",-1),f=n("p",null,[o("以这个为例: 入参是: "),n("code",null,"/api/sns/web/v1/search/hotlist?source=search_box"),o(" 返回值如下图：")],-1),T=n("p",null,"此时找到第一个生成返回值的位置，如下：",-1),W=n("p",null,[o("经分析，加密字符串种，只有"),n("code",null,"payload"),o("是动态参数。那现在的任务，就是找到"),n("code",null,"payload"),o("的加密算法和被加密字符串。")],-1),k=n("p",null,[o("继续找 "),n("code",null,"payload"),o(" 的第一个生成位置，如下：")],-1),w=e("",4),j=n("p",null,"因为这一串数组，在加密和解密之前，这有理由让我相信它是加密算法的一部分，虽然看不懂，但是可以去搜索啊。",-1),V=n("p",null,[o("此时，我们再也压不住心中的喜悦了。果然是 "),n("code",null,"DES"),o(" 加密算法。")],-1),Y=n("p",null,"继续往上翻日志，发现它的加密字符串了。",-1),M=e("",9),N=n("p",null,[o("此时得到："),n("code",null,"url=/api/sns/web/v1/search/hotlist?source=search_box")],-1),Z=e("",4),P=e("",4),S=e("",3),G=e("",2),z=e("",5),O=e("",8),R=n("p",null,"正常返回的结果，说明我们分析对了。晚上吃面给自己奖励一个荷包蛋吧！！",-1);function U(Q,J,L,H,K,X){const p=C,a=F("ClientOnly"),c=t,r=E;return i(),u("div",null,[B,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/1.png",alt:"vscode-debugger-1"})]),_:1}),A,m,d,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/2.png",alt:"vscode-debugger-1"})]),_:1}),D,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/3.png",alt:"vscode-debugger-1"})]),_:1}),_,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/4.png",alt:"vscode-debugger-1"})]),_:1}),q,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/5.png",alt:"vscode-debugger-1"})]),_:1}),h,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/6.png",alt:"vscode-debugger-1"})]),_:1}),g,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/7.png",alt:"vscode-debugger-1"})]),_:1}),x,v,I,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/8.png",alt:"vscode-debugger-1"})]),_:1}),f,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/9.png",alt:"vscode-debugger-1"})]),_:1}),T,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/10.png",alt:"vscode-debugger-1"})]),_:1}),W,k,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/11.png",alt:"vscode-debugger-1"})]),_:1}),w,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/12.png",alt:"vscode-debugger-1"})]),_:1}),j,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/13.png",alt:"vscode-debugger-1"})]),_:1}),V,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/14.png",alt:"vscode-debugger-1"})]),_:1}),Y,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/15.png",alt:"vscode-debugger-1"})]),_:1}),M,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/16.png",alt:"vscode-debugger-1"})]),_:1}),N,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/17.png",alt:"vscode-debugger-1"})]),_:1}),Z,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/18.png",alt:"vscode-debugger-1"})]),_:1}),P,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/19.png",alt:"vscode-debugger-1"})]),_:1}),S,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/20.png",alt:"vscode-debugger-1"})]),_:1}),G,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/21.png",alt:"vscode-debugger-1"})]),_:1}),z,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/22.png",alt:"vscode-debugger-1"})]),_:1}),O,s(a,null,{default:l(()=>[s(p,{src:"/images/reverse/jsreverse/xhs/23.png",alt:"vscode-debugger-1"})]),_:1}),R,s(a,null,{default:l(()=>[s(c)]),_:1}),s(a,null,{default:l(()=>[s(r)]),_:1})])}const rs=y(b,[["render",U]]);export{cs as __pageData,rs as default};
